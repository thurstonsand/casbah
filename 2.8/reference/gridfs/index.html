<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="">
<meta name="author" content="">
<meta name="keyword" content="">

    <link rel="shortcut icon" href="/casbah/2.8/img/favicon.png">

    <title>GridFS</title>

    <link rel="stylesheet" href="/casbah/2.8/lib/bootstrap.css" type="text/css" />
<link rel="stylesheet" href="/casbah/2.8/lib/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="/casbah/2.8/css/mongodb-docs.css" type="text/css" />
<link rel="stylesheet" href="/casbah/2.8/css/overrides.css" type="text/css" />
<link rel="stylesheet" href="/casbah/2.8/lib/highlight/styles/idea.css" />
<link rel="stylesheet" href="/casbah/2.8/lib/bootstrap-toggle/bootstrap-toggle.min.css" type="text/css" />
<link rel="stylesheet" href="/casbah/2.8/css/java.css" type="text/css" />


  </head>

  <body>
  
  <section id="container" class="">
      
      <header id="header-db" class="row" role="navigation">
  <div class="header-content">
    <div class="toggle-nav pull-left">
        <i class="fa fa-bars"></i>
        <div class="icon-reorder tooltips" data-original-title="Toggle Navigation" data-placement="bottom"></div>
    </div>
    
    <div class="logo pull-left">
      <a href="/casbah/2.8/../">
        <img src="/casbah/2.8/img/logo-mongodb-header.png", alt="MongoDB.org" />
      </a>
    </div>
    
    <div>
<div class="nav-items pull-right">
  <a href="http://try.mongodb.org/" data-toggle="tooltip" data-placement="bottom" title="Try MongoDB in the browser">Try it Out</a>
  <a href="http://www.mongodb.org/downloads" data-toggle="tooltip" data-placement="bottom" title="Download MongoDB">Downloads</a>
  <a href="http://www.mongodb.org/get-involved" data-toggle="tooltip" data-placement="bottom" title="Get involved with MongoDB">Community</a>
  <a href="http://docs.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Documentation">Docs</a>
  <a href="http://blog.mongodb.org" data-toggle="tooltip" data-placement="bottom" title="The MongoDB Blog">Blog</a>
  <div id="search">
<form method="get" action="//www.google.com/search" target="_blank">
    <input type="text" name="searchQuery" size="20" value="" autocomplete="off" placeholder="Search docs">
    <input type="hidden" name="site" value="/casbah/2.8">
    <input type="hidden" name="q" value="">
    <label for="searchQuery"><i class="fa fa-search fa-1"></i></label>
</form>
</div>

</div>
</div>

  </div>
</header>

      

      
<aside id="sidebar" class="sidebar">
    <div class="ssidebar nav-collapse">
      <div class="ssidebarwrapper">
        <h3>
          <a class="index-link" href="/casbah/2.8/../">Casbah</a>
          <a class="version pull-right" href="/casbah/2.8">2.8</a>
        </h3>

        
        <ul class="sidebar-menu">
          
          
          
          
          
          
          
          
          
          
          
          

          
          
            
            









  


          
            
            









  
    
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  


        
          
        
      
    
      
      
        
        
        
        
        
        
        
        









  
  
  
  
  
  
  
  

  
    
    
    
  
  


        
      
    
      
      
        
      
    
    
  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          
            
            









  


          

          

          
            
            
















    <li class="toctree-l1">
    <a href="/casbah/2.8/getting-started/">
        <i class='fa fa-road'></i>
        Getting Started
    </a>
  </li>


          
            
            













  




<li class="toctree-l1  current">
  <a href="/casbah/2.8/reference/" class="">
      <i class='fa fa-book'></i>
      <span>Reference</span>
      <span class="menu-arrow fa fa-angle-down"></span>
  </a>
    <ul  class="current">
        
        
        
        
















    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/installation/">
        
        Installation
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/modules/">
        
        Casbah Modules
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/connecting/">
        
        Connecting to MongoDB
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/querying/">
        
        Querying
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/query_dsl/">
        
        Query DSL
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/aggregation/">
        
        Aggregation
    </a>
  </li>


        
        
        
        
        













  




    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/gridfs/">
        
        GridFS
    </a>
  </li>


        
        
        
        
        
















    <li class="toctree-l2">
    <a href="/casbah/2.8/reference/serialisation/">
        
        Serialisation
    </a>
  </li>


        
        
    </ul>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/casbah/2.8/changelog/">
        <i class='fa fa-file-text'></i>
        Changelog
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/casbah/2.8/examples/">
        <i class='fa fa-lightbulb-o'></i>
        Examples
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/casbah/2.8/whats-new/">
        <i class='fa fa-gift'></i>
        Whats new
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/casbah/2.8/upgrade/">
        <i class='fa fa-wrench'></i>
        Upgrade
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/casbah/2.8/scaladoc/">
        <i class='fa fa-file-text-o'></i>
        API Documentation
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="https://github.com/mongodb/casbah">
        <i class='fa fa-github'></i>
        Source Code
    </a>
  </li>


          
            
            
















    <li class="toctree-l1">
    <a href="/casbah/2.8/issues-help/">
        <i class='fa fa-life-ring'></i>
        Issues &amp; Help
    </a>
  </li>


          
        </ul>
        
    </div>
  </div>
  
</aside>

<div class="option-popup closed hidden" id="optionsVersionsPopup">
<div class="option-header">
  <i class="fa fa-gear"></i>
  <span>OPTIONS</span>
  <i class="fa fa-angle-up pull-right"></i>
</div>
<div class="option-body">
  <ul>
      
      <li>
        <label>Version</label>
        <div class="btn-group btn-group-xs pull-right">
          <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
            Select Version <span class="caret"></span>
          </button>
          <ul class="dropdown-menu" role="menu" id="optionsVersionsMenu">
          </ul>
        </div>
      </li>

   


    

  </ul>
</div>
</div>



      
      <section id="main-content" class="content">
          <section class="main-column pull-left">
            <div class="document">
              <div class="documentwrapper">
                <div class="bodywrapper">
                  <div class="body">


   
<a class="edit-link" href="https://github.com/mongodb/casbah/blob/2.8.x/docs/reference/content/reference/gridfs.md" target="_blank" title="Edit reference/gridfs.md on GitHub"><i class="fa fa-pencil-square-o"></i></a>










<div class="bc">
<ul>
  
  
  
  
  
  <li><a href="/casbah/2.8/reference/">Reference</a> <i class="fa fa-angle-right"></i></li>
  <li>GridFS</li>
</ul>
</div>




<h1 id="gridfs">GridFS</h1>

<p><code>GridFS</code> is a specification for storing and retrieving files that exceed
the BSON-document <a href="http://docs.mongodb.org/manual/reference/limits/#BSON%20Document%20Size">size
limit</a>
of 16MB.</p>

<p>Instead of storing a file in a single document, GridFS divides a file
into parts, or chunks, and stores each of those chunks as a
separate document. By default GridFS limits chunk size to 256k. GridFS
uses two collections to store files. One collection stores the file
chunks, and the other stores file metadata.</p>

<p>When you query a GridFS store for a file, the driver or client will
reassemble the chunks as needed. You can perform range queries on files
stored through GridFS. You also can access information from arbitrary
sections of files, which allows you to &ldquo;skip&rdquo; into the middle of a video
or audio file.</p>

<p>GridFS is useful not only for storing files that exceed 16MB but also
for storing any files for which you want access without having to load
the entire file into memory. For more information on the indications of
GridFS, see
<a href="http://docs.mongodb.org/manual/faq/developers/#faq-developers-when-to-use-gridfs">faq-developers-when-to-use-gridfs</a>.</p>

<p><div class="admonition note">
<h5 class="admonition-title">Note</h5>
<p>The use of the term <em>chunks</em> in the context of GridFS is not related to the use of the term <em>chunks</em> in the context of sharding.</p>

</div>
</p>

<h2 id="using-gridfs-in-casbah">Using GridFS in Casbah</h2>

<p>GridFS is a separate package in Casbah and to use it you must import it
explicitly. See the <a href="http://mongodb.github.io/casbah/api/#com.mongodb.casbah.gridfs.package">full gridfs api
docs</a>
for more information about the package.</p>

<p>Example use case:</p>

<pre><code class="language-scala">import java.io.FileInputStream
import com.mongodb.casbah.Imports._
import com.mongodb.casbah.gridfs.Imports._

// Connect to the database
val mongoClient = MongoClient()(&quot;test&quot;)

// Pass the connection to the GridFS class
val gridfs = GridFS(mongoClient)

// Save a file to GridFS
val logo = new FileInputStream(&quot;mongo.png&quot;)
val id = gridfs(logo) { f =&gt;
    f.filename = &quot;mongodb_logo.png&quot;
    f.contentType = &quot;image/png&quot;
}

// Find a file in GridFS by its ObjectId
val myFile = gridfs.findOne(id.get.asInstanceOf[ObjectId])

// Or find a file in GridFS by its filename
val myFile = gridfs.findOne(&quot;mongodb_logo.png&quot;)

// Print all filenames stored in GridFS
for (f &lt;- gridfs) println(f.filename)
</code></pre>

<h3 id="joda-datetime">Joda DateTime</h3>

<p>Due to hardcoding in the Java GridFS driver the Joda Time serialization
hooks break with GridFS. It tries to explicitly cast certain date fields
as a <code>java.util.Date</code>. To that end, on all find ops we explicitly unload
the Joda Time deserializers and reload them when we&rsquo;re done (if they
were loaded before we started). This allows GridFS to always work but
<em>MAY</em> cause thread safety issues - e.g. if you have another non-GridFS
read happening at the same time in another thread at the same time, it
may fail to deserialize BSON Dates as Joda DateTime - and blow up. Be
careful &mdash; generally we don&rsquo;t recommend mixing Joda Time and GridFS in
the same JVM at the moment.</p>






<div id="btnv">
  
  <div class="pull-left">
  <a class="navigation prev" href="/casbah/2.8/reference/aggregation/">
      <i class="fa fa-long-arrow-left"> </i> Aggregation
  </a>
  </div>
  
  
  <div class="pull-right">
  <a class="navigation next" href="/casbah/2.8/reference/serialisation/">
    Serialisation <i class="fa fa-long-arrow-right"> </i>
  </a>
  
</div>
</div>


</div>
<div class="right-column">
<div class="wrapper">
  
  <div class="toc">
    <span class="toc-header">On this page</span>
    <nav id="TableOfContents">
<ul>
<li><a href="#gridfs">GridFS</a>
<ul>
<li><a href="#using-gridfs-in-casbah">Using GridFS in Casbah</a>
<ul>
<li><a href="#joda-datetime">Joda DateTime</a></li>
</ul></li>
</ul></li>
</ul>
</nav>
  </div>
  
</div>
</div>

</div>
</div>
</div>
</section>
</section>

</section>


<script type="text/javascript">
  var DOCUMENTATION_OPTIONS = {
   URL_ROOT:    "/casbah/2.8",
   VERSION:     "2.8",
   COLLAPSE_INDEX: false,
   FILE_SUFFIX: '.html',
   HAS_SOURCE:  true
  };
</script>
<script type="text/javascript" src="/casbah/2.8/js/jquery.js"></script>
<script type="text/javascript" src="/casbah/2.8/lib/bootstrap.js"></script>
<script type="text/javascript" src="/casbah/2.8/js/navbar.js"></script>
<script type="text/javascript" src="/casbah/2.8/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="/casbah/2.8/js/scripts.js"></script>
<script type="text/javascript" src="/casbah/2.8/lib/bootstrap-toggle/bootstrap-toggle.min.js"></script>
<script type="text/javascript" src="/casbah/2.8/js/scala.js"></script>



<noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-K75Z5Q"
height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
{'gtm.start': new Date().getTime(),event:'gtm.js'}
);var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
'//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-K75Z5Q');</script>


<script type="text/javascript">
var _elqQ = _elqQ || [];
_elqQ.push(['elqSetSiteId', '413370795']);
_elqQ.push(['elqTrackPageView']);
(function () {
function async_load()
{ var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true; s.src = '//img03.en25.com/i/elqCfg.min.js'; var x = document.getElementsByTagName('script')[0]; x.parentNode.insertBefore(s, x); }
if (window.addEventListener) window.addEventListener('DOMContentLoaded', async_load, false);
else if (window.attachEvent) window.attachEvent('onload', async_load);
})();
</script>

</body>
</html>

